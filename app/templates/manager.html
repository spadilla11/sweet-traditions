{% extends 'base.html' %}
{% load static %}
{% block content %}

<nav class="manager-navbar">
    <ul>
        <li><a href="{% url 'logout' %}" class="btn btn-secondary">Logout</a></li>
        <li><a href="{% url 'menu' %}">View Menu</a></li>
        <li style="float: right; color: white; margin-right: 2%;"><h2>Welcome {{ request.user.first_name }} {{ request.user.last_name }}</h2></li>
    </ul>
</nav>

<h1>Manager Dashboard</h1>
<div class="menu-management">
    <div class="add-menu-item">
        <h1>Add New Menu Item</h1>
        <form method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">Add Item</button>
        </form>
    </div>

    <div class="edit-delete-menu-item">
        {% for item in menu_items %}
            <li style="margin-bottom: 2%;">
                {{ item.name }} 
                <form method="post" action="{% url 'edit_menu_item' item.id %}" style="display:inline;">
                    {% csrf_token %}
                    <div> Edit Item:
                    <input type="text" name="name" value="{{ item.name }}" />
                    <input type="number" step="0.01" name="price" value="{{ item.price }}" />
                    <input type="text" name="description" value="{{ item.description }}" />
                    <input type="checkbox" name="available" {% if item.available %}checked{% endif %} />
                    <button type="submit">Save</button>

                    </div>
                </form>

                <form method="post" action="{% url 'delete_menu_item' item.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" onclick="return confirm('Are you sure you want to delete this item?');">Delete</button>
                </form>
                

            </li>
        {% empty %}
            <li>No menu items found.</li>
        {% endfor %}
    </div>
</div>

<div class="current-orders">
    <h1>Current Orders</h1>
    {% if orders %}
        {% for order in orders %}
            <div class="order-card" style="text-align: left;">
                <h3>Order #{{ order.id }}</h3>
                <p>Customer: {{ order.customer.username }}</p>
                <p>Status: {{ order.status }}</p>
                <p>Date: {{ order.date|date:"M d, Y" }}</p>
                <ul>
                    {% for item in order.items.all %}
                        <li>{{ item.name }} â€” ${{ item.price }}</li>
                    {% endfor %}
                </ul>
                <strong>Total: ${{ order.total }}</strong>
            </div>
            <hr></hr>
        {% endfor %}
    {% else %}
        <p>No current orders.</p>
    {% endif %}
</div>

{% endblock content %}